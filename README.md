# King's Speech

[![Lint, Build, Deploy](https://github.com/vegardege/kings-speech/actions/workflows/lint-build-deploy.yml/badge.svg)](https://github.com/vegardege/kings-speech/actions/workflows/lint-build-deploy.yml)

King's Speech is a web application providing statistics and analysis about the Danish Monarch's yearly New Year's Eve speeches. It serves as an interactive exploration tool for linguistic patterns and historical trends in Danish royal New Year's Eve speeches.

## Motivation

This is a personal project created to explore linguistic patterns in the Danish royal New Year's Eve speeches. The application provides an interactive interface for discovering word usage trends, comparing monarchs, and finding interesting trivia about these historic addresses.

> [!NOTE]
> This is a personal project shared in the spirit of open source. I haven't spent time making it production-ready for others. That said, the instructions below should help you reproduce it if you're interested.

## Quick Start

### Run with Docker (pre-built image)

If you have the royal-pipes database ready (see [Building the Database](#building-the-database)):

```bash
docker run -p 3000:3000 -v ~/.local/share/royal-pipes:/app/data/royal-pipes vegardege/kings-speech:latest
```

Then open [http://localhost:3000](http://localhost:3000)

## Full Setup

Want to build everything from scratch? Here's how.

### Prerequisites

- **Node.js** 20+ (the project uses Node.js 25 in Docker)
- **npm** (comes with Node.js)
- Basic familiarity with command line

### Building the Database

King's Speech is a **display layer** that reads from a SQLite database generated by the [royal-pipes](https://github.com/vegardege/royal-pipes) project.

#### Step 1: Set up royal-pipes

Follow the instructions in the [royal-pipes repository](https://github.com/vegardege/royal-pipes) to:

1. Download the Danish royal New Year's Eve speeches
2. Process them through the analytics pipeline
3. Generate the `analytics.db` SQLite database

This database contains all the statistical data about word frequencies, trends, and patterns.

#### Step 2: Database location

By default, King's Speech looks for the database at:

- `$XDG_DATA_HOME/royal-pipes/analytics.db` (if `XDG_DATA_HOME` is set)
- `~/.local/share/royal-pipes/analytics.db` (default)

Make sure the royal-pipes database is available at one of these locations.

### Running the Web App

#### Development mode

```bash
npm install
npm run dev
```

Open [http://localhost:3000](http://localhost:3000)

#### Production mode

```bash
npm install
npm run build
npm run start
```

### Docker (build your own image)

```bash
# Build the image
docker build -t kings-speech:latest .

# Run with volume mount for database
docker run -p 3000:3000 -v ~/.local/share/royal-pipes:/app/data/royal-pipes kings-speech:latest
```

The database file is mounted as a volume, which means you can update the data without rebuilding the Docker image.

## Development

### Code Quality

This project uses [Biome](https://biomejs.dev/) for linting and formatting:

```bash
npm run check        # Check for issues
npm run check:fix    # Auto-fix issues

npm run lint         # Lint only
npm run lint:fix     # Auto-fix lint issues (alias for check:fix)

npm run format       # Format only
npm run format:fix   # Auto-fix formatting (alias for check:fix)
```

### Tech Stack

- **Framework**: Next.js 16 (App Router)
- **Frontend**: React 19, TypeScript
- **Styling**: TailwindCSS 4
- **Internationalization**: next-intl (English and Danish)
- **Code Quality**: Biome
- **Database**: SQLite (read-only from royal-pipes)
- **Runtime**: Node.js 20+

### Architecture

The application uses **Static Site Generation (SSG)** with full pre-rendering:

- All pages (14,000+) are pre-generated at build time
- Build takes ~4 minutes and outputs ~600MB
- No server-side rendering at runtime
- Database queries happen only during build

This approach ensures excellent performance while the build remains acceptable for a personal project.

### Internationalization

The app supports English and Danish using `next-intl`. All UI text uses translation strings from `messages/en.json` and `messages/da.json`, while database content (words, names) stays in Danish.

## Contributing

This is a personal project, but contributions are welcome!

The best way to contribute is by improving the [royal-pipes](https://github.com/vegardege/royal-pipes) data pipeline. Better data processing, new statistics, and enhanced analysis benefit this display layer directly.

UI improvements, bug fixes, and suggestions are also appreciated. Feel free to open issues or pull requests.
